{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Login | Grupo GC</title>

  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
  <link rel="stylesheet" href="{% static 'extrato_app/css/conta_virtual.css' %}" />

  <style>
    .login-wrapper{display:flex;align-items:center;justify-content:center;min-height:60vh}
    .login-card{max-width:520px;margin:0 auto}
    .input-wrap{position:relative}
    .toggle-pass{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:transparent;border:none;cursor:pointer;color:#666}
    .modal-backdrop{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);align-items:center;justify-content:center;padding:16px;z-index:9999}
    .modal-backdrop.open{display:flex}
    .modal{width:min(520px,92vw);background:#fff;color:#222;border-radius:16px;overflow:hidden;box-shadow:0 12px 40px rgba(0,0,0,.18)}
    .modal-header{padding:14px 16px;background:#f6f7fb;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e6e7ee}
    .modal-title{font-weight:800}
    .modal-body{padding:16px}
    .modal-footer{padding:12px 16px;border-top:1px solid #e6e7ee;display:flex;gap:8px;justify-content:flex-end;background:#fafbfe}
    .close-btn{background:transparent;border:none;font-size:1.4rem;cursor:pointer;color:#444}
    .form-error{
  margin-top: 6px;
  color: #EF4444;
  display: none;
  font-size: .95rem;
}
    .form-error.show{ display:block; }
  </style>

</head>
<body>
  <div class="main-content">

    
    <header>
      <div class="header-content">
        <a href="/"><img src="{% static 'extrato_app/GRUPOGC_RGB_LOGOTIPO_OFFWHITE.png' %}" alt="IMAGEM LOGO" style="max-height:75px;"></a>
        <div class="header-divider"></div>
      </div>
    </header>

    <div class="container login-wrapper">
    <div class="form-card login-card">
        <h2><i class="bi bi-box-arrow-in-right"></i> Acessar</h2>

        <form id="formLogin" method="POST" action="{% url 'auth_login' %}" onsubmit="return false;">
        {% csrf_token %}

        <div class="form-group">
            <label class="form-label"><i class="bi bi-person-fill"></i> Usuário (e-mail ou login)</label>
            <input type="text" class="form-select" name="username" id="username" placeholder="seu.email@empresa.com" required />
        </div>

        <div class="form-group">
            <label class="form-label"><i class="bi bi-shield-lock-fill"></i> Senha</label>
            <div class="input-wrap">
            <input type="password" class="form-select" name="password" id="password" placeholder="••••••••" required />
            <button type="button" class="toggle-pass" id="togglePass" aria-label="Mostrar/ocultar senha">
                <i class="bi bi-eye-slash"></i>
            </button>
            </div>
            <div class="info-badge" style="cursor:pointer" id="btnForgot">
            <i class="bi bi-question-circle"></i> Esqueci minha senha
            </div>
        </div>

        <div id="loginError" class="form-error" aria-live="polite"></div>

        <div class="form-group">
             
            <button class="btn-primary" type="button" id="btnSubmit" disabled aria-disabled="true">
            <i class="bi bi-arrow-right-circle"></i> Prosseguir
            </button>

        </div>
        </form>
    </div>
    </div>

    <footer>
      <div class="container"><p>© 2025 Grupo GC - Todos os direitos reservados</p></div>
    </footer>
  </div>

  <!-- Toast / Notificação -->
  <div id="notification" class="notification popup-hidden" aria-live="polite"><i id="notification-icon"></i><span id="notification-message"></span></div>

  <!-- Popup de processamento -->
  <div id="download-popup" class="popup popup-hidden" role="dialog" aria-modal="true" aria-labelledby="popup-title">
    <div class="popup-content">
      <div class="spinner"></div>
      <p id="popup-title">Autenticando... aguarde.</p>
    </div>
  </div>

  <!-- Popup de resultado (check animado) -->
  <div id="resultToast" class="toast-backdrop" aria-hidden="true">
    <div class="toast-card">
      <div class="toast-icon success" id="toastIconSuccess" aria-hidden="true">
        <svg class="checkmark" viewBox="0 0 52 52">
          <circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>
          <path class="checkmark__check" fill="none" d="M14 27l7 7 16-16"/>
        </svg>
      </div>
      <div class="toast-icon error" id="toastIconError" aria-hidden="true">
        <svg class="cross" viewBox="0 0 52 52">
          <circle class="cross__circle" cx="26" cy="26" r="25" fill="none"/>
          <path class="cross__line cross__line--left" fill="none" d="M16 16 36 36"/>
          <path class="cross__line cross__line--right" fill="none" d="M36 16 16 36"/>
        </svg>
      </div>
      <h3 id="toastTitle">Sucesso!</h3>
      <p id="toastMsg"></p>
      <div class="toast-actions"><button class="btn-primary" id="toastClose" type="button">OK</button></div>
    </div>
  </div>

  <!-- Modal "Esqueci minha senha" -->
  <div class="modal-backdrop" id="forgotBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="forgotTitle">
      <div class="modal-header">
        <div class="modal-title" id="forgotTitle"><i class="bi bi-envelope-paper"></i> Recuperar acesso</div>
        <button class="close-btn" id="forgotClose" type="button" aria-label="Fechar">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label"><i class="bi bi-at"></i> Seu e-mail corporativo</label>
          <input type="email" class="form-select" id="forgotEmail" placeholder="seu.email@empresa.com" required />
          <div class="info-badge"><i class="bi bi-info-circle"></i> Enviaremos um link de redefinição de senha.</div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" id="forgotCancel" type="button">Cancelar</button>
        <button class="btn-primary" id="forgotSend" type="button"><i class="bi bi-send"></i> Enviar</button>
      </div>
    </div>
  </div>

  <script>
    (function(){const t=document.querySelector('input[name="csrfmiddlewaretoken"]');if(t)window.csrfToken=t.value;})();
  </script>
  <script src="{% static 'extrato_app/js/login.js' %}"></script>
</body>
</html>
